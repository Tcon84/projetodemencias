<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fatores de Risco Modific√°veis - Projeto Dem√™ncias</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <header>
        <h1>Projeto Dem√™ncias - ULS Loures-Odivelas</h1>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li class="dropdown">
                    <a href="#" class="dropbtn">Menu</a>
                    <div class="dropdown-content">
                        <a href="mim@uf.html">mim@uf</a>
                        <a href="SClinicoMed.html">SCl√≠nico Med</a>
                        <a href="SClinicoEnf.html">SCl√≠nico Enf</a>
                        <a href="FerramentasDeAvaliacao.html">Ferramentas de avalia√ß√£o</a>
                        <a href="CriteriosDeReferenciacao.html">Crit√©rios de referencia√ß√£o</a>
                        <a href="Vacinacao.html">Vacina√ß√£o</a>
                        <a href="Cuidador.html">Cuidador</a>
                        <a href="ProtecaoSocial.html">Prote√ß√£o social e recursos na comunidade</a>
                        <a href="Formacao.html">Forma√ß√£o</a>
                        <a href="Investigacao.html">Investiga√ß√£o</a>
                    </div>
                </li>
            </ul>
        </nav>
    </header>

    <section>
        <h2>Fatores de Risco Modific√°veis</h2>
        <p>Esta infografia apresenta os principais fatores de risco modific√°veis associados ao desenvolvimento de dem√™ncia e destaca a import√¢ncia da preven√ß√£o e interven√ß√£o precoce.</p>
        
        <!-- Aqui entra a tua infografia -->
        <div class="infografia">
            <!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dem√™ncia: 45% do Risco √© Control√°vel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
   
    <!--
    Plano da Narrativa:
    1. Gancho (A Crise): N√∫meros principais e a mensagem central.
    2. O Problema (Preval√™ncia e Causas): Detalhar n√∫meros globais e nacionais.
    3. O "Porqu√™" (Fardo e Limites): Fardo elevado e limita√ß√£o dos tratamentos.
    4. A Esperan√ßa (Potencial de Preven√ß√£o): Estat√≠stica de "45% preven√≠vel".
    5. O "Como" (14 Fatores de Risco): Detalhar os 14 fatores de risco modific√°veis + Aconselhamento Gemini.
    6. A Estrat√©gia (Brain Health Check-up): O fluxo de 4 passos nos Cuidados de Sa√∫de Prim√°rios.
    7. A Conclus√£o: O Imperativo da Interven√ß√£o Multicomponente.
    -->
   
    <!--
    Princ√≠pios de Visualiza√ß√£o:
    - Uso exclusivo de Tailwind CSS, Chart.js, e elementos HTML/CSS/JS base.
    - Aus√™ncia de SVG, Mermaid ou imagens externas (exceto placehold.co se estritamente necess√°rio).
    - Design totalmente responsivo.
    -->
   
    <!-- Paleta de Cores: Brilliant Blues (#004AAD, #0094FF, #5BC9F9, #B3E5FC, #F0F9FF) -->

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F0F9FF; /* Fundo muito claro */
            color: #1a202c;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .stat-card {
            background-color: white;
            border-radius: 0.75rem; /* Mais arredondado */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); /* Sombra mais suave */
            padding: 1.5rem;
            transition: all 0.3s ease;
        }
        .stat-card:hover {
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.1);
            transform: translateY(-4px); /* Eleva√ß√£o maior */
        }
        .risk-factor-card {
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.05);
            padding: 1rem;
            border-left-width: 6px; /* Borda mais grossa */
            border-color: #0094FF;
            display: flex;
            align-items: center;
            font-size: 0.95rem;
            font-weight: 500;
        }
        .flow-step {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            padding: 1.5rem;
            text-align: center;
            border: 2px solid #B3E5FC; /* Borda vis√≠vel */
            width: 100%;
            max-width: 200px;
            min-height: 200px; /* Altura m√≠nima para uniformidade */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        @media (min-width: 1024px) {
            .flow-step {
                max-width: 250px;
            }
        }
    </style>
</head>
<body class="antialiased">

    <div class="container mx-auto p-4 md:p-10">
       
        <header class="text-center mb-12 py-8 bg-white rounded-xl shadow-lg">
            <h1 class="text-4xl md:text-5xl font-extrabold text-[#004AAD] mb-2">Dem√™ncia: 45% do Risco √© Control√°vel</h1>
            <p class="text-xl text-gray-600 font-light">O seu guia para a preven√ß√£o e sa√∫de cerebral.</p>
        </header>

        <section id="prevalencia" class="mb-16">
            <h2 class="text-3xl font-bold text-[#004AAD] text-center mb-8">A Crise em N√∫meros: Preval√™ncia Global</h2>
            <p class="text-lg text-gray-700 max-w-3xl mx-auto text-center mb-12">
                A dem√™ncia √© um dos maiores desafios de sa√∫de do nosso tempo, impulsionada pelo envelhecimento da popula√ß√£o. Os n√∫meros atuais j√° s√£o altos e as proje√ß√µes futuras exigem uma a√ß√£o imediata.
            </p>
           
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
               
                <div class="stat-card lg:col-span-2">
                    <h3 class="text-xl font-semibold text-[#004AAD] mb-2">Proje√ß√£o Global de Casos de Dem√™ncia</h3>
                    <p class="text-gray-600 mb-4">O n√∫mero de pessoas com dem√™ncia dever√° quase triplicar at√© 2050, passando de 57 milh√µes em 2019 para 153 milh√µes.</p>
                    <div class="chart-container" style="height: 300px; max-height: 350px;">
                        <canvas id="globalProjectionChart"></canvas>
                    </div>
                </div>

                <div class="stat-card">
                    <h3 class="text-xl font-semibold text-[#004AAD] mb-2">Preval√™ncia por Idade</h3>
                    <p class="text-gray-600 mb-4">O risco aumenta drasticamente com a idade, afetando mais de um ter√ßo das pessoas com 90 anos ou mais.</p>
                    <div class="chart-container" style="height: 300px; max-height: 350px;">
                        <canvas id="agePrevalenceChart"></canvas>
                    </div>
                </div>

                <div class="stat-card md:col-span-2">
                    <h3 class="text-xl font-semibold text-[#004AAD] mb-2">Causas Mais Comuns</h3>
                    <p class="text-gray-600 mb-4">A Doen√ßa de Alzheimer √© a causa mais frequente, respondendo pela grande maioria dos casos de dem√™ncia.</p>
                    <div class="chart-container" style="height: 300px; max-height: 350px;">
                        <canvas id="causesChart"></canvas>
                    </div>
                </div>
               
                <div class="stat-card lg:col-span-2">
                    <h3 class="text-xl font-semibold text-[#004AAD] mb-4">Panorama Global e Nacional</h3>
                    <p class="text-gray-600 mb-6">O impacto √© global. Enquanto a proje√ß√£o mundial atinge 153 milh√µes, v√°rios pa√≠ses enfrentam aumentos dram√°ticos de casos.</p>
                   
                    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 text-center">
                        <div>
                            <span class="text-5xl font-bold text-[#0094FF] block">153 Milh√µes</span>
                            <p class="text-gray-600 mt-2 text-sm">Casos Projetados Mundialmente (2050)</p>
                        </div>
                        <div>
                            <span class="text-5xl font-bold text-[#0094FF] block">200 Mil</span>
                            <p class="text-gray-600 mt-2 text-sm">Casos estimados em Portugal (2018)</p>
                        </div>
                    </div>
                </div>

            </div>
        </section>

        <section id="porque-prevenir" class="mb-16">
            <h2 class="text-3xl font-bold text-[#004AAD] text-center mb-8">Porque a Preven√ß√£o √© a Nossa Melhor Ferramenta</h2>
            <p class="text-lg text-gray-700 max-w-3xl mx-auto text-center mb-12">
                A dem√™ncia imp√µe um fardo enorme aos pacientes, cuidadores e sistemas de sa√∫de. Com tratamentos curativos limitados, o foco deve mudar para a preven√ß√£o.
            </p>
           
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
                <div class="stat-card text-center p-6 sm:p-8">
                    <span class="text-5xl font-extrabold text-[#004AAD] block">40%</span>
                    <p class="text-lg text-gray-700 mt-3">Dos cuidadores relatam sintomas depressivos, e 30% sentem-se completamente sobrecarregados.</p>
                </div>
                <div class="stat-card text-center p-6 sm:p-8">
                    <span class="text-3xl font-extrabold text-[#004AAD] block">Custos Elevados</span>
                    <p class="text-lg text-gray-700 mt-3">O aumento de casos gera custos econ√≥micos e sociais que exigem uma resposta urgente dos sistemas de sa√∫de.</p>
                </div>
                <div class="stat-card text-center p-6 sm:p-8">
                    <span class="text-3xl font-extrabold text-[#004AAD] block">Tratamentos Limitados</span>
                    <p class="text-lg text-gray-700 mt-3">As terapias atuais s√£o sintom√°ticas e n√£o revertem a progress√£o da doen√ßa, tornando a preven√ß√£o crucial.</p>
                </div>
            </div>

            <div class="stat-card text-center p-8 md:p-12 bg-gradient-to-r from-[#004AAD] to-[#0094FF] text-white">
                <h3 class="text-4xl font-extrabold mb-4">A Janela da Esperan√ßa: 45%</h3>
                <p class="text-xl max-w-2xl mx-auto mb-6">
                    Estima-se que at√© 45% (quase metade) de todos os casos de dem√™ncia poderiam ser teoricamente prevenidos ou atrasados ao abordar fatores de risco modific√°veis ao longo da vida.
                </p>
                <div class="chart-container" style="height: 300px; max-height: 350px;">
                    <canvas id="preventionPotentialChart"></canvas>
                </div>
            </div>
        </section>
       
        <section id="como-prevenir" class="mb-16">
            <h2 class="text-3xl font-bold text-[#004AAD] text-center mb-8">Como Prevenir: 14 Fatores de Risco Modific√°veis</h2>
            <p class="text-lg text-gray-700 max-w-3xl mx-auto text-center mb-8">
                A Comiss√£o Lancet 2024 identificou 14 fatores de risco onde a interven√ß√£o pode ter o maior impacto. Nunca √© demasiado cedo ou demasiado tarde para come√ßar a proteger a sa√∫de do seu c√©rebro.
            </p>

            <div>
                <h3 class="text-2xl font-semibold text-[#004AAD] mb-4">Dom√≠nios de Interven√ß√£o Chave</h3>
               
                <div class="mb-6">
                    <h4 class="text-xl font-semibold text-gray-700 mb-3">Sa√∫de Vascular e Metab√≥lica</h4>
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                        <div class="risk-factor-card"><span class="text-2xl mr-3">ü©∫</span><span class="font-semibold">Hipertens√£o</span></div>
                        <div class="risk-factor-card"><span class="text-2xl mr-3">üçî</span><span class="font-semibold">Obesidade</span></div>
                        <div class="risk-factor-card"><span class="text-2xl mr-3">ü©∏</span><span class="font-semibold">Diabetes Mellitus</span></div>
                        <div class="risk-factor-card"><span class="text-2xl mr-3">ü•ì</span><span class="font-semibold">Colesterol LDL Elevado</span></div>
                    </div>
                </div>

                <div class="mb-6">
                    <h4 class="text-xl font-semibold text-gray-700 mb-3">Estilo de Vida e Comportamental</h4>
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                        <div class="risk-factor-card"><span class="text-2xl mr-3">üèÉ</span><span class="font-semibold">Inatividade F√≠sica</span></div>
                        <div class="risk-factor-card"><span class="text-2xl mr-3">üö¨</span><span class="font-semibold">Tabagismo</span></div>
                        <div class="risk-factor-card"><span class="text-2xl mr-3">üç∫</span><span class="font-semibold">Consumo Excessivo de √Ålcool</span></div>
                        <div class="risk-factor-card"><span class="text-2xl mr-3">ü§ï</span><span class="font-semibold">Traumatismo Craniano</span></div>
                    </div>
                </div>

                <div class="mb-6">
                    <h4 class="text-xl font-semibold text-gray-700 mb-3">Psicossocial e Sensorial</h4>
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                        <div class="risk-factor-card"><span class="text-2xl mr-3">üéì</span><span class="font-semibold">Baixa Escolaridade</span></div>
                        <div class="risk-factor-card"><span class="text-2xl mr-3">üëÇ</span><span class="font-semibold">Perda Auditiva</span></div>
                        <div class="risk-factor-card"><span class="text-2xl mr-3">üëì</span><span class="font-semibold">D√©fice Visual</span></div>
                        <div class="risk-factor-card"><span class="text-2xl mr-3">üòî</span><span class="font-semibold">Depress√£o</span></div>
                        <div class="risk-factor-card"><span class="text-2xl mr-3">üó£Ô∏è</span><span class="font-semibold">Isolamento Social</span></div>
                    </div>
                </div>

                 <div class="mb-6">
                    <h4 class="text-xl font-semibold text-gray-700 mb-3">Ambiental</h4>
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                        <div class="risk-factor-card"><span class="text-2xl mr-3">üí®</span><span class="font-semibold">Polui√ß√£o Atmosf√©rica</span></div>
                    </div>
                </div>
            </div>
           
            <!-- Gemini API Feature 1: Risk Factor Deep Dive -->
            <div class="stat-card mt-10 p-6">
                <h3 class="text-2xl font-bold text-[#004AAD] mb-4 flex items-center">
                    A√ß√µes Preventivas Detalhadas ‚ú®
                </h3>
                <p class="text-gray-600 mb-4">Selecione um fator de risco para obter as recomenda√ß√µes mais recentes e baseadas em evid√™ncias sobre como o gerir ou mitigar (Powered by Gemini Search).</p>
                <div class="flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4 mb-4">
                    <select id="riskFactorSelect" class="p-3 border border-gray-300 rounded-lg w-full md:w-2/3 focus:outline-none focus:ring-2 focus:ring-[#0094FF]">
                        <option value="">Selecione um Fator de Risco...</option>
                        <option value="Hipertens√£o">Hipertens√£o (PA ‚â§ 130 mmHg)</option>
                        <option value="Obesidade na Meia-Idade">Obesidade na Meia-Idade</option>
                        <option value="Diabetes Mellitus">Diabetes Mellitus (Controlo Glic√©mico)</option>
                        <option value="Colesterol LDL Elevado">Colesterol LDL Elevado</option>
                        <option value="Inatividade F√≠sica">Inatividade F√≠sica (150 min/semana)</option>
                        <option value="Tabagismo">Tabagismo (Cessa√ß√£o)</option>
                        <option value="Consumo Excessivo de √Ålcool">Consumo Excessivo de √Ålcool</option>
                        <option value="Traumatismo Cranioencef√°lico (TCE)">Traumatismo Cranioencef√°lico (Preven√ß√£o)</option>
                        <option value="Baixa Escolaridade">Baixa Escolaridade (Atividade Cognitiva)</option>
                        <option value="Perda Auditiva n√£o corrigida">Perda Auditiva n√£o corrigida (Rastreio e Tratamento)</option>
                        <option value="D√©fice Visual n√£o corrigido">D√©fice Visual n√£o corrigido (Rastreio e Tratamento)</option>
                        <option value="Depress√£o">Depress√£o (Tratamento Eficaz)</option>
                        <option value="Isolamento Social">Isolamento Social (Participa√ß√£o Comunit√°ria)</option>
                        <option value="Polui√ß√£o Atmosf√©rica">Polui√ß√£o Atmosf√©rica (Redu√ß√£o da Exposi√ß√£o)</option>
                    </select>
                    <button id="generateAdviceButton" class="w-full md:w-1/3 bg-[#0094FF] text-white p-3 rounded-lg font-semibold hover:bg-[#004AAD] transition-colors">
                        Obter Aconselhamento ‚ú®
                    </button>
                </div>
                <div id="adviceOutput" class="mt-4 p-4 border border-[#B3E5FC] rounded-lg bg-[#F0F9FF] min-h-[100px] text-gray-700">
                    <p>Aguardando a sele√ß√£o de um fator de risco...</p>
                </div>
                <div id="adviceCitations" class="text-xs text-gray-500 mt-2"></div>
            </div>
            <!-- End Gemini API Feature 1 -->

        </section>

        <section id="estrategia" class="mb-16">
            <h2 class="text-3xl font-bold text-[#004AAD] text-center mb-8">A Estrat√©gia: O "Brain Health Check-up"</h2>
            <p class="text-lg text-gray-700 max-w-3xl mx-auto text-center mb-12">
                Os Cuidados de Sa√∫de Prim√°rios (CSP) s√£o fundamentais para implementar a preven√ß√£o. A proposta de um "Check-up de Sa√∫de Cerebral" visa integrar esta abordagem na rotina cl√≠nica a partir dos 50 anos.
            </p>

            <!-- NOVO FLUXO DE 4 PASSOS -->
            <div class="flex flex-col lg:flex-row items-stretch justify-center space-y-6 lg:space-y-0 lg:space-x-4">
               
                <!-- Passo 1: Revis√£o dos fatores de risco e c√°lculo do LIBRA 2 - LINK ADICIONADO AQUI -->
                <div class="flow-step">
                    <span class="text-4xl mb-2">1Ô∏è‚É£</span>
                    <h4 class="text-lg font-semibold text-[#004AAD] my-2 flex flex-col items-center">
                        Revis√£o de Risco & LIBRA 2
                        <a href="https://www.evidencio.com/models/show/1041?utm_source=chatgpt.com" target="_blank" class="text-sm font-normal text-[#0094FF] hover:underline flex items-center mt-1">
                            Calcular LIBRA Score üîó
                        </a>
                    </h4>
                    <p class="text-gray-600 text-sm flex-grow">Medi√ß√£o de par√¢metros biom√©tricos (PA, IMC) e avalia√ß√£o do estilo de vida para c√°lculo e estratifica√ß√£o do risco (Ex: √çndice LIBRA 2).</p>
                </div>
               
                <div class="text-4xl text-[#0094FF] self-center transform rotate-90 lg:rotate-0 hidden lg:block">‚Üí</div>
                <div class="text-4xl text-[#0094FF] self-center lg:hidden">‚ñº</div>


                <!-- Passo 2: Avalia√ß√£o Cognitiva Breve -->
                <div class="flow-step">
                    <span class="text-4xl mb-2">2Ô∏è‚É£</span>
                    <h4 class="text-lg font-semibold text-[#004AAD] my-2">Avalia√ß√£o Cognitiva Breve</h4>
                    <p class="text-gray-600 text-sm flex-grow">Rastreio de perdas sensoriais (audi√ß√£o, vis√£o) e screening cognitivo inicial para detetar queixas precoces (Ex: Mini-Cog, MoCA).</p>
                </div>
               
                <div class="text-4xl text-[#0094FF] self-center transform rotate-90 lg:rotate-0 hidden lg:block">‚Üí</div>
                <div class="text-4xl text-[#0094FF] self-center lg:hidden">‚ñº</div>
               
                <!-- Passo 3: Educa√ß√£o e aconselhamento -->
                <div class="flow-step">
                    <span class="text-4xl mb-2">3Ô∏è‚É£</span>
                    <h4 class="text-lg font-semibold text-[#004AAD] my-2">Educa√ß√£o e Aconselhamento</h4>
                    <p class="text-gray-600 text-sm flex-grow">Fornecer feedback individualizado sobre o risco e as √°reas priorit√°rias a melhorar, capacitando o utente a gerir a sua sa√∫de cerebral.</p>
                </div>
               
                <div class="text-4xl text-[#0094FF] self-center transform rotate-90 lg:rotate-0 hidden lg:block">‚Üí</div>
                <div class="text-4xl text-[#0094FF] self-center lg:hidden">‚ñº</div>

                <!-- Passo 4: Plano de A√ß√£o Multidisciplinar -->
                <div class="flow-step">
                    <span class="text-4xl mb-2">4Ô∏è‚É£</span>
                    <h4 class="text-lg font-semibold text-[#004AAD] my-2">Plano de A√ß√£o Multidisciplinar</h4>
                    <p class="text-gray-600 text-sm flex-grow">Desenvolver um plano de interven√ß√£o multicomponente (dieta, exerc√≠cio, controlo vascular) com apoio multidisciplinar e monitoriza√ß√£o cont√≠nua.</p>
                </div>
            </div>
            <!-- FIM DO NOVO FLUXO -->
        </section>
       
        <section id="conclusao" class="mb-12">
            <div class="stat-card p-8 bg-gray-50 border-t-4 border-[#004AAD]">
                <h2 class="text-3xl font-bold text-[#004AAD] text-center mb-6">Conclus√£o: O Imperativo da Interven√ß√£o Multicomponente</h2>

                <p class="text-lg text-gray-700 max-w-4xl mx-auto text-center mb-4">
                    Face ao fardo epidemiol√≥gico e econ√≥mico crescente da dem√™ncia, impulsionado pelo envelhecimento populacional, a preven√ß√£o representa a estrat√©gia mais robusta e urgente. A falta de terap√™uticas curativas eficazes exige a otimiza√ß√£o da reserva cognitiva e a prote√ß√£o da sa√∫de vascular cerebral.
                </p>
                <p class="text-lg text-gray-700 max-w-4xl mx-auto text-center font-extrabold text-[#0094FF]">
                    Ao intervir nos 14 fatores de risco modific√°veis ao longo da vida, √© poss√≠vel prevenir ou adiar aproximadamente 45% dos casos. A implementa√ß√£o sistem√°tica de uma abordagem multicomponente, integrada nos Cuidados de Sa√∫de Prim√°rios (CSP), √© fundamental para maximizar os anos de vida saud√°vel e a dignidade.
                </p>
             </div>
        </section>

        <footer class="text-center text-gray-500 text-sm mt-12 py-4 border-t border-gray-200">
            <p>Infogr√°fico gerado com base no "Relat√≥rio: O Imperativo da Preven√ß√£o da Dem√™ncia".</p>
        </footer>

    </div>

    <script>
        // Fun√ß√µes Auxiliares para Chart.js
        const tooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) {
                return label.join(' ');
            } else {
                return label;
            }
        };
       
        const wrapLabels = (label, maxWidth = 16) => {
            const words = label.split(' ');
            const lines = [];
            let currentLine = '';
            words.forEach(word => {
                if ((currentLine + ' ' + word).trim().length > maxWidth) {
                    lines.push(currentLine.trim());
                    currentLine = word;
                } else {
                    currentLine = (currentLine + ' ' + word).trim();
                }
            });
            lines.push(currentLine.trim());
            return lines;
        };

        const palette = {
            darkBlue: '#004AAD',
            brightBlue: '#0094FF',
            mediumBlue: '#5BC9F9',
            lightBlue: '#B3E5FC',
            bgBlue: '#F0F9FF',
            gray: '#4A5568'
        };

        // Op√ß√µes globais para gr√°ficos de barras/linhas
        const globalChartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    labels: {
                        color: '#1a202c',
                        font: { size: 14 }
                    }
                },
                tooltip: {
                    callbacks: {
                        title: tooltipTitleCallback
                    }
                }
            },
            scales: {
                x: {
                    ticks: { color: palette.gray },
                    grid: { display: false }
                },
                y: {
                    ticks: { color: palette.gray },
                    grid: { color: '#E2E8F0' }
                }
            }
        };

        // Op√ß√µes globais para gr√°ficos circulares (Donut/Doughnut)
        const globalPieOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        color: '#1a202c',
                        padding: 20,
                        font: { size: 12 }
                    }
                },
                tooltip: {
                    callbacks: {
                        title: tooltipTitleCallback
                    }
                }
            }
        };

        document.addEventListener('DOMContentLoaded', () => {

            // 1. Proje√ß√£o Global de Casos de Dem√™ncia (Gr√°fico de Linha)
            new Chart(document.getElementById('globalProjectionChart'), {
                type: 'line',
                data: {
                    labels: ['2019', '2050'],
                    datasets: [{
                        label: 'Milh√µes de Casos',
                        data: [57, 153],
                        borderColor: palette.brightBlue,
                        backgroundColor: 'rgba(0, 148, 255, 0.15)',
                        fill: true,
                        tension: 0.2,
                        borderWidth: 3,
                        pointBackgroundColor: palette.brightBlue,
                        pointRadius: 6,
                        pointHoverRadius: 8
                    }]
                },
                options: { ...globalChartOptions }
            });

            // 2. Preval√™ncia por Idade (Gr√°fico de Barras)
            new Chart(document.getElementById('agePrevalenceChart'), {
                type: 'bar',
                data: {
                    labels: ['65-70 anos', '90+ anos', '65+ (Geral)'],
                    datasets: [{
                        label: 'Preval√™ncia (%)',
                        data: [3, 35, 10],
                        backgroundColor: [palette.lightBlue, palette.darkBlue, palette.mediumBlue],
                        borderColor: [palette.lightBlue, palette.darkBlue, palette.mediumBlue],
                        borderWidth: 1
                    }]
                },
                options: {
                    ...globalChartOptions,
                    plugins: {
                        legend: { display: false },
                        tooltip: { callbacks: { title: tooltipTitleCallback } }
                    }
                }
            });

            // 3. Causas Mais Comuns (Gr√°fico de Rosca)
            new Chart(document.getElementById('causesChart'), {
                type: 'doughnut',
                data: {
                    labels: [
                        wrapLabels('Doen√ßa de Alzheimer (60-80%)'),
                        wrapLabels('Dem√™ncia Vascular (5-10%)'),
                        wrapLabels('Corpos de Lewy (~5%)'),
                        wrapLabels('Degenera√ß√£o Frontotemporal (~3%)'),
                        'Outras'
                    ],
                    datasets: [{
                        label: 'Causas de Dem√™ncia',
                        data: [70, 7.5, 5, 3, 14.5],
                        backgroundColor: [palette.darkBlue, palette.brightBlue, palette.mediumBlue, palette.lightBlue, palette.gray],
                        hoverOffset: 8
                    }]
                },
                options: {
                    ...globalPieOptions,
                    plugins: {
                        ...globalPieOptions.plugins,
                        legend: {
                            ...globalPieOptions.plugins.legend,
                            position: 'right',
                            align: 'center'
                        }
                    }
                }
            });
           
            // 4. Potencial de Preven√ß√£o (Gr√°fico de Rosca Grande)
            new Chart(document.getElementById('preventionPotentialChart'), {
                type: 'doughnut',
                data: {
                    labels: ['Potencialmente Preven√≠vel (45%)', 'N√£o Modific√°vel (55%)'],
                    datasets: [{
                        data: [45, 55],
                        backgroundColor: [palette.mediumBlue, palette.lightBlue],
                        borderColor: ['white', 'white'],
                        borderWidth: 5,
                        hoverOffset: 12
                    }]
                },
                options: {
                    ...globalPieOptions,
                    plugins: {
                        ...globalPieOptions.plugins,
                        legend: {
                            ...globalPieOptions.plugins.legend,
                            labels: {
                                ...globalPieOptions.plugins.legend.labels,
                                color: '#FFFFFF'
                            }
                        }
                    },
                    cutout: '70%' // Donut mais estreito
                }
            });

            // --- Gemini API Implementations ---

            const apiKey = "";
            const LLM_API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

            // Helper for exponential backoff
            const fetchWithRetry = async (url, options, retries = 3) => {
                for (let i = 0; i < retries; i++) {
                    try {
                        const response = await fetch(url, options);
                        if (response.status === 429 && i < retries - 1) {
                            console.warn(`Retry attempt ${i + 1} for 429.`);
                            await new Promise(resolve => setTimeout(resolve, Math.pow(2, i) * 1000 + Math.random() * 1000));
                            continue;
                        }
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        return response;
                    } catch (error) {
                        if (i === retries - 1) {
                            throw error;
                        }
                    }
                }
            };
           
            // --- Feature 1: Risk Factor Deep Dive (Search Grounding) ---

            const adviceSelect = document.getElementById('riskFactorSelect');
            const generateButton = document.getElementById('generateAdviceButton');
            const adviceOutput = document.getElementById('adviceOutput');
            const adviceCitations = document.getElementById('adviceCitations');

            const callGeminiApiForText = async (query) => {
                const systemPrompt = "Aja como um especialista em sa√∫de cerebral e preven√ß√£o de dem√™ncia. Forne√ßa uma resposta concisa de 2-3 par√°grafos, focada em a√ß√µes pr√°ticas e baseadas em evid√™ncias para mitigar o seguinte fator de risco, incluindo metas concretas (ex: PA < 130 mmHg). Utilize as fontes de pesquisa dispon√≠veis.";
               
                const payload = {
                    contents: [{
                        parts: [
                            { text: query },
                            { text: "Responda em Portugu√™s de Portugal. Formate a resposta usando par√°grafos e negrito para destacar metas ou recomenda√ß√µes chave." }
                        ]
                    }],
                    tools: [{ "google_search": {} }],
                    systemInstruction: {
                        parts: [{ text: systemPrompt }]
                    },
                };

                const options = {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                };

                try {
                    const response = await fetchWithRetry(LLM_API_URL, options);
                    const result = await response.json();
                    const candidate = result.candidates?.[0];

                    if (candidate && candidate.content?.parts?.[0]?.text) {
                        const text = candidate.content.parts[0].text;
                        let sources = [];
                        const groundingMetadata = candidate.groundingMetadata;
                        if (groundingMetadata && groundingMetadata.groundingAttributions) {
                            sources = groundingMetadata.groundingAttributions
                                .map(attribution => ({
                                    uri: attribution.web?.uri,
                                    title: attribution.web?.title,
                                }))
                                .filter(source => source.uri && source.title);
                        }
                        return { text, sources };
                    } else {
                        return { text: "Erro: N√£o foi poss√≠vel obter aconselhamento detalhado. Tente novamente.", sources: [] };
                    }
                } catch (error) {
                    console.error("Gemini API Error:", error);
                    return { text: "Ocorreu um erro ao comunicar com a API. Por favor, verifique a sua liga√ß√£o ou tente mais tarde.", sources: [] };
                }
            };

            generateButton.addEventListener('click', async () => {
                const factor = adviceSelect.value;
                if (!factor) {
                    adviceOutput.innerHTML = '<p class="text-red-600">Por favor, selecione um fator de risco na lista.</p>';
                    adviceCitations.innerHTML = '';
                    return;
                }

                adviceOutput.innerHTML = '<p class="text-center text-[#004AAD] font-semibold flex items-center justify-center"><span class="animate-spin mr-2">‚ü≥</span> A gerar o aconselhamento mais recente para ' + factor + '...</p>';
                adviceCitations.innerHTML = '';
                generateButton.disabled = true;

                const query = `Forne√ßa a√ß√µes pr√°ticas de preven√ß√£o de dem√™ncia focadas no fator de risco: ${factor}.`;
                const { text, sources } = await callGeminiApiForText(query);

                // Substitui quebras de linha duplas por novos par√°grafos HTML e simples por <br>
                const formattedText = text
                    .split('\n\n')
                    .map(p => `<p class="mb-3">${p.replace(/\n/g, ' ')}</p>`)
                    .join('');

                adviceOutput.innerHTML = formattedText;
               
                if (sources.length > 0) {
                    const sourceHtml = 'Fontes (clique para detalhes): ' + sources.map((s, index) =>
                        `<a href="${s.uri}" target="_blank" class="text-[#0094FF] hover:underline">${s.title} (${index + 1})</a>`
                    ).join(' | ');
                    adviceCitations.innerHTML = sourceHtml;
                } else {
                    adviceCitations.innerHTML = 'Nenhuma fonte espec√≠fica encontrada pela pesquisa.';
                }

                generateButton.disabled = false;
            });
           
            // TTS related functions and variables were fully removed to clean up the code.
        });
    </script>
</body>
</html>
        </div>
    </section>

    <script src="scripts.js"></script>
</body>
</html>
